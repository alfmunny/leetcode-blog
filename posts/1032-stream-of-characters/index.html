<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>1032 - Stream of Characters | LeetCode In The Shell</title>
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="../../">Home</a></li>
      
      <li><a href="../../about/">About</a></li>
      
      <li><a href="../../categories/">Categories</a></li>
      
      <li><a href="../../tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">1032 - Stream of Characters</span></h1>

<h2 class="date">2020/08/23</h2>
</div>

<main>
<p><a href="https://leetcode.com/problems/stream-of-characters/">leetcode</a></p>
<h2 id="problem">Problem</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Implement the StreamChecker class as follows:

StreamChecker(words): Constructor, init the data structure with the given words.
query(letter): returns true if and only if for some k &gt;= 1, the last k characters queried (in order from oldest to newest, including this letter just queried) spell one of the words in the given list.


Example:

StreamChecker streamChecker = new StreamChecker([&#34;cd&#34;,&#34;f&#34;,&#34;kl&#34;]); // init the dictionary.
streamChecker.query(&#39;a&#39;);          // return false
streamChecker.query(&#39;b&#39;);          // return false
streamChecker.query(&#39;c&#39;);          // return false
streamChecker.query(&#39;d&#39;);          // return true, because &#39;cd&#39; is in the wordlist
streamChecker.query(&#39;e&#39;);          // return false
streamChecker.query(&#39;f&#39;);          // return true, because &#39;f&#39; is in the wordlist
streamChecker.query(&#39;g&#39;);          // return false
streamChecker.query(&#39;h&#39;);          // return false
streamChecker.query(&#39;i&#39;);          // return false
streamChecker.query(&#39;j&#39;);          // return false
streamChecker.query(&#39;k&#39;);          // return false
streamChecker.query(&#39;l&#39;);          // return true, because &#39;kl&#39; is in the wordlist


Note:

1 &lt;= words.length &lt;= 2000
1 &lt;= words[i].length &lt;= 2000
Words will only consist of lowercase English letters.
Queries will only consist of lowercase English letters.
The number of queries is at most 40000.
</code></pre></div><h2 id="solution">Solution</h2>
<p>It&rsquo;s clearly a trie problem. But how to optimize it?</p>
<p>We must keep trace of the stream, and try to search the every pattern in the trace.
But that would be LTE.</p>
<p>In order not to loop through every starting point of the trace, we do it reversely, so we only need to start from the beginning once and stop for the existing word.</p>
<p>For example:</p>
<p>[&ldquo;dlab&rdquo;, &ldquo;xlab&rdquo;]</p>
<p>Create a reversed trie [&ldquo;bald&rdquo;, &ldquo;balx&rdquo;]</p>
<p>trace = &ldquo;&quot;, max length of trace = 4, because, all words in the trie are not longer than 4.</p>
<p>&ldquo;b&rdquo;: trace = &ldquo;b&rdquo;, search for &ldquo;b&rdquo; in the trie, False
&ldquo;a&rdquo;: trace = &ldquo;ba&rdquo;, search for &ldquo;ba&rdquo; in the trie, False
&ldquo;l&rdquo;: trace = &ldquo;bal&rdquo;, search for &ldquo;bal&rdquo; in the trie, False
&ldquo;d&rdquo;: trace = &ldquo;bald&rdquo;,  search for &ldquo;bald&rdquo; in the trie, True
&ldquo;x&rdquo;: trace = &ldquo;aldx&rdquo;, search for &ldquo;aldx&rdquo; in the trie, False</p>
<p>Steps:</p>
<ol>
<li>create the trie with reversed words</li>
<li>keep the track of the stream with a max possible length</li>
<li>search the track of the stream in the &ldquo;reversed&rdquo; trie.</li>
</ol>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StreamChecker</span>:

    <span style="color:#66d9ef">def</span> __init__(self, words: List[str]):
        self<span style="color:#f92672">.</span>root <span style="color:#f92672">=</span> TrieNode()

        <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> words:
            x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>root
            <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> reversed(w):
                <span style="color:#66d9ef">if</span> c <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>children:
                    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>children[c]
                <span style="color:#66d9ef">else</span>:
                    x<span style="color:#f92672">.</span>children[c] <span style="color:#f92672">=</span> TrieNode()
                    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>children[c]
            x<span style="color:#f92672">.</span>is_word <span style="color:#f92672">=</span> True

        self<span style="color:#f92672">.</span>s <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>
        self<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> max(map(len, words))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">query</span>(self, letter: str) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> bool:

        self<span style="color:#f92672">.</span>s <span style="color:#f92672">=</span> (letter<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>s)[:self<span style="color:#f92672">.</span>w]
        x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>root
        res <span style="color:#f92672">=</span> False

        <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>s:
            <span style="color:#66d9ef">if</span> c <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>children:
                x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>children[c]
                <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>is_word:
                    <span style="color:#66d9ef">return</span> True
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">return</span> False

        <span style="color:#66d9ef">return</span> res


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TrieNode</span>:
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>children <span style="color:#f92672">=</span> {}
        self<span style="color:#f92672">.</span>is_word <span style="color:#f92672">=</span> False
</code></pre></div><p>Simplified Version</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> collections
<span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StreamChecker</span>:
    <span style="color:#66d9ef">def</span> __init__(self, words):
        T <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span>: collections<span style="color:#f92672">.</span>defaultdict(T)
        self<span style="color:#f92672">.</span>trie <span style="color:#f92672">=</span> T()
        <span style="color:#66d9ef">for</span> w <span style="color:#f92672">in</span> words: reduce(dict<span style="color:#f92672">.</span>__getitem__, w[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], self<span style="color:#f92672">.</span>trie)[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">=</span> True
        self<span style="color:#f92672">.</span>s <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>
        self<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> max(map(len, words))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">query</span>(self, letter):
        self<span style="color:#f92672">.</span>s <span style="color:#f92672">=</span> (letter <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>s)[:self<span style="color:#f92672">.</span>w]
        cur <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>trie
        <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>s:
            <span style="color:#66d9ef">if</span> c <span style="color:#f92672">in</span> cur:
                cur <span style="color:#f92672">=</span> cur[c]
                <span style="color:#66d9ef">if</span> c[<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#</span><span style="color:#e6db74">&#34;</span>] <span style="color:#f92672">==</span> True:
                    <span style="color:#66d9ef">return</span> True
            <span style="color:#66d9ef">else</span>:
                <span style="color:#66d9ef">break</span>

        <span style="color:#66d9ef">return</span> False
</code></pre></div>
</main>

  <footer>
  
  
  <hr/>
  Â© <a href="http://alfmunny.com">Alfmunny</a> 2019 &ndash; 2020| <a href="https://github.com/alfmunny">Github</a> | <a href="https://twitter.com/alfmunny">Twitter</a>
  
  </footer>
  </body>
</html>

