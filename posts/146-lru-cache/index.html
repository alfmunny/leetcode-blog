<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>146 - LRU Cache | LeetCode In The Shell</title>
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="../../">Home</a></li>
      
      <li><a href="../../about/">About</a></li>
      
      <li><a href="../../categories/">Categories</a></li>
      
      <li><a href="../../tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">146 - LRU Cache</span></h1>

<h2 class="date">2020/04/25</h2>
</div>

<main>
<p><a href="https://leetcode.com/problems/lru-cache/">leetcode</a></p>
<h2 id="problem">Problem</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Design and implement a data structure for Least Recently Used (LRU) cache. It should support the following operations: get and put.

get(key) - Get the value (will always be positive) of the key if the key exists in the cache, otherwise return -1.
put(key, value) - Set or insert the value if the key is not already present. When the cache reached its capacity, it should invalidate the least recently used item before inserting a new item.

The cache is initialized with a positive capacity.

Follow up:
Could you do both operations in O(1) time complexity?

Example:

LRUCache cache = new LRUCache( 2 /* capacity */ );

cache.put(1, 1);
cache.put(2, 2);
cache.get(1);       // returns 1
cache.put(3, 3);    // evicts key 2
cache.get(2);       // returns -1 (not found)
cache.put(4, 4);    // evicts key 1
cache.get(1);       // returns -1 (not found)
cache.get(3);       // returns 3
cache.get(4);       // returns 4
</code></pre></div><h2 id="solution">Solution</h2>
<ol>
<li>
<p>How to manage to have a O(1) for get()?</p>
<p>Hash Table</p>
</li>
<li>
<p>How to manage to have a O(1) for put()?</p>
<p>We have to somehow maintain its order, when something is added.</p>
<p>Linked list would come to mind at first. But how we can change its order when we call get() on a node
and also be able to delete the last one. We would like to know the previous one of a node.</p>
<p>A <strong>Double Linked List</strong> is a perfect match.</p>
</li>
</ol>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LRUCache</span>:

    <span style="color:#66d9ef">def</span> __init__(self, capacity: int):
        self<span style="color:#f92672">.</span>count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        self<span style="color:#f92672">.</span>capacity <span style="color:#f92672">=</span> capacity
        self<span style="color:#f92672">.</span>hash <span style="color:#f92672">=</span> {}
        self<span style="color:#f92672">.</span>head <span style="color:#f92672">=</span> Node(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
        self<span style="color:#f92672">.</span>tail <span style="color:#f92672">=</span> Node(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
        self<span style="color:#f92672">.</span>head<span style="color:#f92672">.</span>next <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>tail
        self<span style="color:#f92672">.</span>tail<span style="color:#f92672">.</span>prev <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>head

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(self, key: int) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> int:
        <span style="color:#66d9ef">if</span> key <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>hash:
            node <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>hash[key]
            self<span style="color:#f92672">.</span>_remove(node)
            self<span style="color:#f92672">.</span>_add(node)
            <span style="color:#66d9ef">return</span> node<span style="color:#f92672">.</span>value
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">put</span>(self, key: int, value: int) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> None:
        <span style="color:#66d9ef">if</span> key <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>hash:
            node <span style="color:#f92672">=</span> Node(key, value)
            self<span style="color:#f92672">.</span>hash[key] <span style="color:#f92672">=</span> node
            self<span style="color:#f92672">.</span>count <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
            self<span style="color:#f92672">.</span>_add(node)
        <span style="color:#66d9ef">else</span>:
            node <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>hash[key]
            node<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span> value
            self<span style="color:#f92672">.</span>get(key)

        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>count <span style="color:#f92672">&gt;</span> self<span style="color:#f92672">.</span>capacity:
            n <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>tail<span style="color:#f92672">.</span>prev
            self<span style="color:#f92672">.</span>hash<span style="color:#f92672">.</span>pop(n<span style="color:#f92672">.</span>key)
            self<span style="color:#f92672">.</span>_remove(n)
            self<span style="color:#f92672">.</span>count <span style="color:#f92672">-</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_connect</span>(self, p, n):
        p<span style="color:#f92672">.</span>next, n<span style="color:#f92672">.</span>prev <span style="color:#f92672">=</span> n, p

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_add</span>(self, n):
        tmp <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>head<span style="color:#f92672">.</span>next
        self<span style="color:#f92672">.</span>_connect(self<span style="color:#f92672">.</span>head, n)
        self<span style="color:#f92672">.</span>_connect(n, tmp)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_remove</span>(self, node):
        self<span style="color:#f92672">.</span>_connect(node<span style="color:#f92672">.</span>prev, node<span style="color:#f92672">.</span>next)



<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Node</span>:
    <span style="color:#66d9ef">def</span> __init__(self, key, value):
        self<span style="color:#f92672">.</span>key <span style="color:#f92672">=</span> key
        self<span style="color:#f92672">.</span>value <span style="color:#f92672">=</span>  value
        self<span style="color:#f92672">.</span>prev <span style="color:#f92672">=</span> None
        self<span style="color:#f92672">.</span>next <span style="color:#f92672">=</span> None


<span style="color:#75715e"># Your LRUCache object will be instantiated and called as such:</span>
<span style="color:#75715e"># obj = LRUCache(capacity)</span>
<span style="color:#75715e"># param_1 = obj.get(key)</span>
<span style="color:#75715e"># obj.put(key,value)</span>
</code></pre></div>
</main>

  <footer>
  
  
  <hr/>
  Â© <a href="http://alfmunny.com">Alfmunny</a> 2019 &ndash; 2020| <a href="https://github.com/alfmunny">Github</a> | <a href="https://twitter.com/alfmunny">Twitter</a>
  
  </footer>
  </body>
</html>

