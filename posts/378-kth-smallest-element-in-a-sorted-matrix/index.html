<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>378 - Kth Smallest Element in a Sorted Matrix | LeetCode In The Shell</title>
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="../../">Home</a></li>
      
      <li><a href="../../about/">About</a></li>
      
      <li><a href="../../categories/">Categories</a></li>
      
      <li><a href="../../tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">378 - Kth Smallest Element in a Sorted Matrix</span></h1>

<h2 class="date">2020/11/19</h2>
</div>

<main>
<p><a href="https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/">leetcode</a></p>
<h2 id="problem">Problem</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Given a n x n matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.

Note that it is the kth smallest element in the sorted order, not the kth distinct element.

Example:

matrix = [
   [ 1,  5,  9],
   [10, 11, 13],
   [12, 13, 15]
],
k = 8,

return 13.
</code></pre></div><h2 id="solution">Solution</h2>
<h3 id="solution-1-heap-with-marker">Solution 1: Heap with marker</h3>
<p>Maintain a heap, pop the first one, and push the right one and lower one into the heap.</p>
<p>But we need a mark matrix to tell if the one to be pushed was not visited before,
since it may have been in the heap when we push the lower one, and now we come to this one from left to right.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">kthSmallest</span>(self, matrix: List[List[int]], k: int) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> int:
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> matrix <span style="color:#f92672">or</span> <span style="color:#f92672">not</span> matrix[<span style="color:#ae81ff">0</span>]:
            <span style="color:#66d9ef">return</span> None
        n <span style="color:#f92672">=</span> len(matrix)
        heap <span style="color:#f92672">=</span> []
        heapq<span style="color:#f92672">.</span>heapify(heap)
        heapq<span style="color:#f92672">.</span>heappush(heap, (matrix[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]))
        mark <span style="color:#f92672">=</span> [[False] <span style="color:#f92672">*</span> n <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(n)]
        <span style="color:#66d9ef">while</span> k <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
            ret <span style="color:#f92672">=</span> heapq<span style="color:#f92672">.</span>heappop(heap)
            i, j <span style="color:#f92672">=</span> ret[<span style="color:#ae81ff">1</span>]
            <span style="color:#66d9ef">if</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;</span> n <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> mark[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][j]:
                heapq<span style="color:#f92672">.</span>heappush(heap, (matrix[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][j], [i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, j]))
                mark[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][j] <span style="color:#f92672">=</span> True
            <span style="color:#66d9ef">if</span> j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;</span> n <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> mark[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]:
                heapq<span style="color:#f92672">.</span>heappush(heap, (matrix[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>], [i, j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]))
                mark[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> True
            k <span style="color:#f92672">-</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

        <span style="color:#66d9ef">return</span> ret[<span style="color:#ae81ff">0</span>]
</code></pre></div><h3 id="solution-2-heap-without-marker">Solution 2: Heap without marker</h3>
<p>We can eliminate the marker by push the first column into the heap at once. Then we only need to traverse from left to right.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">kthSmallest</span>(self, matrix: List[List[int]], k: int) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> int:
        n <span style="color:#f92672">=</span> len(matrix)
        heap <span style="color:#f92672">=</span> [(row[<span style="color:#ae81ff">0</span>], index, <span style="color:#ae81ff">0</span>) <span style="color:#66d9ef">for</span> index, row <span style="color:#f92672">in</span> enumerate(matrix)]
        heapify(heap)
        <span style="color:#66d9ef">while</span> k <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
            ret, i, j <span style="color:#f92672">=</span> heapq<span style="color:#f92672">.</span>heappop(heap)
            <span style="color:#66d9ef">if</span> j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;</span> n:
                heappush(heap, (matrix[i][j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>], i, j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
            k <span style="color:#f92672">-</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">return</span> ret
</code></pre></div><h3 id="solution-3-binary-search">Solution 3: Binary Search</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">kthSmallest</span>(self, matrix):
        lo, hi <span style="color:#f92672">=</span> len(matrix), len(matrix[<span style="color:#ae81ff">0</span>])
        <span style="color:#66d9ef">while</span> lo <span style="color:#f92672">&lt;</span> hi:
            mid <span style="color:#f92672">=</span> (lo<span style="color:#f92672">+</span>hi)<span style="color:#f92672">/</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>
            <span style="color:#66d9ef">if</span> sum(bisect<span style="color:#f92672">.</span>bisect_right(matrix[row], mid) <span style="color:#66d9ef">for</span> row <span style="color:#f92672">in</span> matrix) <span style="color:#f92672">&lt;</span> k:
                lo <span style="color:#f92672">=</span> mid<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">else</span>:
                hi <span style="color:#f92672">=</span> mid
</code></pre></div>
</main>

  <footer>
  
  
  <hr/>
  Â© <a href="http://alfmunny.com">Alfmunny</a> 2019 &ndash; 2020| <a href="https://github.com/alfmunny">Github</a> | <a href="https://twitter.com/alfmunny">Twitter</a>
  
  </footer>
  </body>
</html>

