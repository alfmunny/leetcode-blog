<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>124 - Binary Tree Maximum Path Sum | LeetCode In The Shell</title>
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="../../">Home</a></li>
      
      <li><a href="../../about/">About</a></li>
      
      <li><a href="../../categories/">Categories</a></li>
      
      <li><a href="../../tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">124 - Binary Tree Maximum Path Sum</span></h1>

<h2 class="date">2020/04/29</h2>
</div>

<main>
<p><a href="https://leetcode.com/problems/binary-tree-maximum-path-sum/">leetcode</a></p>
<h2 id="problem">Problem</h2>
<p>Given a non-empty binary tree, find the maximum path sum.</p>
<p>For this problem, a path is defined as any sequence of nodes from some starting node to any node in the tree along the parent-child connections. The path must contain at least one node and does not need to go through the root.</p>
<p>Example 1:</p>
<p>Input: [1,2,3]</p>
<p>1
/ \<br>
2   3</p>
<p>Output: 6
Example 2:</p>
<p>Input: [-10,9,20,null,null,15,7]</p>
<p>-10
/ \<br>
9  20
/  \<br>
15   7</p>
<p>Output: 42</p>
<h2 id="solution">Solution</h2>
<p><strong>Important</strong>:</p>
<p>Remember we should find a path, not a sub tree.</p>
<h3 id="solution-1-hash">Solution 1: Hash</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TreeNode</span>:
    <span style="color:#66d9ef">def</span> __init__(self, val<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, left<span style="color:#f92672">=</span>None, right<span style="color:#f92672">=</span>None):
        self<span style="color:#f92672">.</span>val <span style="color:#f92672">=</span> val
        self<span style="color:#f92672">.</span>left <span style="color:#f92672">=</span> left
        self<span style="color:#f92672">.</span>right <span style="color:#f92672">=</span> right

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    h <span style="color:#f92672">=</span> defaultdict(int)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPathSum</span>(self, root: TreeNode) <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> int:
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> root:
            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>sys<span style="color:#f92672">.</span>maxsize

        <span style="color:#66d9ef">return</span> max(self<span style="color:#f92672">.</span>maxPathSumFrom(root), self<span style="color:#f92672">.</span>maxPathSum(root<span style="color:#f92672">.</span>left),
                   self<span style="color:#f92672">.</span>maxPathSum(root<span style="color:#f92672">.</span>right))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPathSumFrom</span>(self, root):

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> root:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>

        <span style="color:#66d9ef">return</span> max(
            root<span style="color:#f92672">.</span>val, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>right),
            root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>left), root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span>
            self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>right) <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>left))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPathSumDfs</span>(self, root):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> root:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>

        <span style="color:#66d9ef">if</span> root <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>h:
            <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>h[root]
        <span style="color:#66d9ef">else</span>:
            rightSum <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>h<span style="color:#f92672">.</span>get(root<span style="color:#f92672">.</span>right, self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>right))
            leftSum <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>h<span style="color:#f92672">.</span>get(root<span style="color:#f92672">.</span>left, self<span style="color:#f92672">.</span>maxPathSumDfs(root<span style="color:#f92672">.</span>left))
            ans <span style="color:#f92672">=</span> max(root<span style="color:#f92672">.</span>val, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> rightSum, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> leftSum)
            self<span style="color:#f92672">.</span>h[root] <span style="color:#f92672">=</span> ans

        <span style="color:#66d9ef">return</span> ans
</code></pre></div><h3 id="solution-2-global-maximum-with-dfs">Solution 2: Global maximum with dfs</h3>
<p>The tricky part here is to update the global maximum always with both left branch and right branch,
but dfs only returns with the larger branch of the node, because we have to keep the left and right side as a &ldquo;path&rdquo; not a &ldquo;tree</p>
<p>Version 1:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    ans <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>sys<span style="color:#f92672">.</span>maxsize

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPathSum</span>(self, root):
        self<span style="color:#f92672">.</span>dfs(root)
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>ans

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(self, root):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> root:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>

        left <span style="color:#f92672">=</span> max(self<span style="color:#f92672">.</span>dfs(root<span style="color:#f92672">.</span>left), <span style="color:#ae81ff">0</span>)
        right <span style="color:#f92672">=</span> max(self<span style="color:#f92672">.</span>dfs(root<span style="color:#f92672">.</span>right), <span style="color:#ae81ff">0</span>)

        self<span style="color:#f92672">.</span>ans <span style="color:#f92672">=</span> max(self<span style="color:#f92672">.</span>ans, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> left <span style="color:#f92672">+</span> right)
        <span style="color:#66d9ef">return</span> root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> max(left, right)
</code></pre></div><p>Version 2: I find it easier to understand</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Solution</span>:
    ans <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>sys<span style="color:#f92672">.</span>maxsize

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">maxPathSum</span>(self, root):
        self<span style="color:#f92672">.</span>dfs(root)
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>ans

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dfs</span>(self, root):
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> root:
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>

        left <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dfs(root<span style="color:#f92672">.</span>left)
        right <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>dfs(root<span style="color:#f92672">.</span>right)

        val <span style="color:#f92672">=</span> max(root<span style="color:#f92672">.</span>val, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> left, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> right)
        self<span style="color:#f92672">.</span>ans <span style="color:#f92672">=</span> max(self<span style="color:#f92672">.</span>ans, val, root<span style="color:#f92672">.</span>val <span style="color:#f92672">+</span> left <span style="color:#f92672">+</span> right)

        <span style="color:#66d9ef">return</span> val
</code></pre></div>
</main>

  <footer>
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "alfmunnystechblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  
  <hr/>
  © <a href="http://alfmunny.com">Alfmunny</a> 2019 &ndash; 2020| <a href="https://github.com/alfmunny">Github</a> | <a href="https://twitter.com/alfmunny">Twitter</a>
  
  </footer>
  </body>
</html>

